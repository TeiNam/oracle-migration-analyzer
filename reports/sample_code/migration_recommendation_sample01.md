# 요약

## 마이그레이션 추천: Aurora PostgreSQL (Refactoring)

귀사의 Oracle 데이터베이스 시스템을 분석한 결과, **Aurora PostgreSQL로의 Refactoring 전략**을 추천드립니다.

### 추천 배경

현재 시스템의 평균 코드 복잡도는 SQL 4.8(낮은), PL/SQL 5.9(중간) 수준입니다. PL/SQL 오브젝트가 3개로 적고 평균 복잡도(5.9)도 중간 수준으로, PL/pgSQL로 변환이 용이합니다.

### 전략 개요

Aurora PostgreSQL은 Oracle과 높은 호환성을 제공하는 오픈소스 데이터베이스입니다. AI 도구(Amazon Q Developer, Bedrock)를 활용하여 PL/SQL의 70-75%를 PL/pgSQL로 자동 변환할 수 있어, 복잡한 비즈니스 로직을 데이터베이스 레벨에서 유지하면서도 라이선스 비용을 절감할 수 있습니다.

### AI 도구 활용 효과

- **기간 단축**: 전통적 방식(16-22주) 대비 50% 단축 → **9-12주**
- **비용 절감**: AI 기반 자동 변환 및 테스트로 인건비 약 45% 절감
- **변환 성공률**: AI 도구로 단순 로직 70-80% 자동 변환, 복잡한 로직도 AI 제안 활용

### 주요 이점

1. **PL/SQL 호환성**: PL/pgSQL로 대부분의 PL/SQL 로직을 변환할 수 있습니다
2. **비용 절감**: Oracle 라이선스 비용이 없어 TCO를 크게 절감할 수 있습니다
3. **고급 기능**: PostgreSQL의 고급 데이터 타입, JSON 지원 등을 활용할 수 있습니다
4. **빠른 변환**: AI 도구로 PL/SQL → PL/pgSQL 변환 자동화

### 주요 고려사항

1. **PL/SQL 변환**: PL/SQL을 PL/pgSQL로 변환하는 작업이 필요합니다 (AI 도구 활용 시 약 3-4주 소요)
2. **일부 기능 미지원**: 패키지 변수, PRAGMA, 외부 프로시저 호출 등 일부 기능은 미지원됩니다
3. **성능 차이**: BULK 연산 대체 시 20-50%의 성능 차이가 발생할 수 있습니다

### 권장 사항

현재 시스템의 복잡도와 PL/SQL 사용량을 고려할 때, Aurora PostgreSQL은 Oracle 기능을 최대한 유지하면서도 비용을 절감할 수 있는 최적의 선택입니다. AI 도구를 적극 활용하여 변환 기간과 비용을 최소화하고, 미지원 기능을 사전에 식별하여 대체 방안을 수립하시기를 권장드립니다.

## 핵심 요약

- **추천 전략**: refactor_postgresql
- **예상 기간**: 9-12주 (AI 도구 활용)

### 주요 이점
- PL/pgSQL로 PL/SQL 로직 대부분 변환 가능
- AI 도구 활용으로 변환 기간 단축 (9-12주, 전통적 방식 대비 50% 단축)
- 오픈소스 기반으로 라이선스 비용 절감
- Aurora PostgreSQL의 고급 기능 활용
- AI 기반 자동 변환으로 인건비 약 45% 절감

### 주요 위험
- PL/SQL 변환 작업 필요 (일부 기능 미지원)
- BULK 연산 대체 시 성능 차이 발생
- 외부 프로시저 호출 미지원


# 목차

1. [요약](#요약)
2. [추천 전략](#추천-전략)
3. [인스턴스 추천](#인스턴스-추천)
4. [추천 근거](#추천-근거)
5. [대안 전략](#대안-전략)
6. [위험 요소 및 완화 방안](#위험-요소-및-완화-방안)
7. [마이그레이션 로드맵](#마이그레이션-로드맵)
8. [분석 메트릭 (부록)](#분석-메트릭-부록)


# 추천 전략

## Aurora PostgreSQL (리팩토링)

**신뢰도**: 중간

이 전략은 AWR/STATSPACK의 누적 데이터 분석을 통해 작성되었습니다.


# 인스턴스 추천

## 권장 인스턴스 타입

- **인스턴스 타입**: db.r6i.large
- **vCPU**: 2
- **메모리**: 16 GB

### 추천 근거

**AWR/Statspack 분석 결과**:
- 평균 CPU 사용률: 4.2%
- 평균 I/O 부하: 16.9 IOPS
- 평균 메모리 사용량: 4.8 GB

**피크 부하 예상 (P99 기준 +20% 여유율)**:
- 예상 피크 CPU: 5.0%
- 예상 피크 I/O: 20.3 IOPS
- 예상 피크 메모리: 5.8 GB

**추천 근거**: 현재 워크로드가 낮은 수준이므로 **db.r6i.large** (vCPU 2, 메모리 16GB)를 추천합니다. Aurora PostgreSQL의 자동 스케일링으로 필요시 유연하게 확장 가능합니다.

### 참고사항

- 위 인스턴스는 현재 성능 메트릭을 기반으로 한 권장 사항입니다
- 실제 마이그레이션 시 부하 테스트를 통해 최적 사이즈를 결정하시기 바랍니다
- Aurora의 경우 자동 스케일링 기능을 활용하여 유연하게 확장 가능합니다


# 추천 근거

## 1. PL/pgSQL은 Oracle PL/SQL의 70-75%를 커버하여 대부분의 로직을 변환할 수 있습니다

**카테고리**: complexity


## 2. Aurora PostgreSQL은 오픈소스 기반으로 Oracle 라이선스 비용이 없어 TCO를 절감할 수 있습니다

**카테고리**: cost


## 3. PL/SQL 평균 복잡도(5.9)가 중간 수준으로 PL/pgSQL 변환이 가능합니다

**카테고리**: complexity

**근거 데이터**:
- avg_plsql_complexity: 5.94




# 대안 전략

## 대안 1: replatform

### 장점
- 코드 변경 최소화
- 빠른 마이그레이션
- 기존 기능 및 성능 유지
### 단점
- Oracle 라이선스 비용 지속 발생
- Single 인스턴스 제약
- 클라우드 네이티브 이점 제한적
### 고려사항
- PL/SQL 변환 위험이 높은 경우
- 빠른 클라우드 전환이 필요한 경우
- 장기적으로 Refactoring 재검토



# 위험 요소 및 완화 방안

## 위험 1: PL/SQL을 PL/pgSQL로 변환 시 일부 기능 미지원 (패키지 변수, PRAGMA 등)

**카테고리**: technical

**심각도**: medium

**완화 방안**: 미지원 기능 사전 식별 및 대체 방안 수립

## 위험 2: 외부 프로시저 호출(UTL_*) 미지원으로 애플리케이션 레벨 처리 필요

**카테고리**: technical

**심각도**: medium

**완화 방안**: 외부 호출 로직을 애플리케이션 서비스로 이관

## 위험 3: 복잡도 7.0 이상 오브젝트가 33.3%로 변환 난이도가 높습니다

**카테고리**: technical

**심각도**: medium

**완화 방안**: 복잡한 오브젝트 우선 분석, 전문가 리뷰



# 마이그레이션 로드맵

**총 예상 기간**: 9-12주

**AI 도구 활용**: 예 (Amazon Q Developer, Bedrock)

**AI 효과**:
- 시간 단축: 약 50%
- 비용 절감: 약 45%
- 품질 향상: 자동 테스트 생성, 코드 리뷰, 버그 조기 발견

**참고**: 위 일정은 AI 도구를 적극 활용하는 것을 전제로 합니다. AI 도구 미사용 시 기간이 약 2배 소요될 수 있습니다.

## Phase 1: 사전 평가 및 설계

**예상 기간**: 2주

**주요 작업**:
- AI 도구(Amazon Q Developer)를 활용한 PL/SQL 호환성 자동 분석
- AI 기반 미지원 기능 자동 식별 및 대체 방안 제시
- PostgreSQL 호환성 검토 (데이터 타입, 함수)
- Aurora PostgreSQL 인스턴스 사이징
- 마이그레이션 일정 및 리소스 계획
**필요 리소스**:
- DBA
- 아키텍트
- 개발자
- 프로젝트 매니저

## Phase 2: 스키마 및 데이터 변환

**예상 기간**: 2주

**주요 작업**:
- 스키마 변환 (AWS SCT + AI 도구 활용)
- AI 기반 데이터 타입 매핑 자동화
- 인덱스 및 제약조건 재설계
- 개발/테스트 환경 Aurora PostgreSQL 구축
- 초기 데이터 마이그레이션 테스트
**필요 리소스**:
- DBA
- 개발자

## Phase 3: PL/SQL to PL/pgSQL 변환

**예상 기간**: 3-4주

**주요 작업**:
- AI 도구(Amazon Q Developer, Bedrock)를 활용한 PL/SQL → PL/pgSQL 자동 변환
- 패키지를 스키마로 재구성
- BULK 연산을 순수 SQL 또는 Chunked Batch로 대체 (AI 제안 활용)
- 트리거 및 시퀀스 변환
- AI 기반 단위 테스트 자동 생성 및 실행
**필요 리소스**:
- 개발자
- DBA
- QA 엔지니어

## Phase 4: 성능 테스트 및 최적화

**예상 기간**: 1-2주

**주요 작업**:
- 부하 테스트 수행
- AI 기반 쿼리 성능 자동 분석 및 튜닝
- 인덱스 최적화
- BULK 연산 대체 로직 성능 검증
- 병목 지점 해결
**필요 리소스**:
- DBA
- 개발자
- QA 엔지니어

## Phase 5: 프로덕션 전환

**예상 기간**: 1-2주

**주요 작업**:
- 프로덕션 Aurora PostgreSQL 클러스터 구축
- 최종 데이터 마이그레이션
- 애플리케이션 배포 (Blue-Green)
- 모니터링 및 알람 설정
- 롤백 계획 준비 및 검증
**필요 리소스**:
- DBA
- 인프라 엔지니어
- 개발자
- 운영팀



# 분석 메트릭 (부록)

## 성능 메트릭

- **평균 CPU 사용률**: 4.2%
- **평균 I/O 부하**: 16.9 IOPS
- **평균 메모리 사용량**: 4.8 GB

## 코드 복잡도 메트릭 (분석된 소스 파일 기준)

- **평균 SQL 복잡도**: 4.75
- **평균 PL/SQL 복잡도**: 5.94
- **복잡도 7.0 이상 SQL 개수**: 4 / 11
- **복잡도 7.0 이상 PL/SQL 개수**: 2 / 7
- **복잡 오브젝트 비율**: 33.3%
- **BULK 연산 개수**: 8

## AWR/Statspack PL/SQL 통계 (데이터베이스 실제 오브젝트)

- **PL/SQL 코드 라인 수**: 274
- **프로시저 수**: 2
- **함수 수**: 1
